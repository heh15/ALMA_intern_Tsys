## README for ALMA Tsys tracking 
ALMA high-frequency observation at Band 9 and Band 10 requires multiple Tsys measurements (more than 10) due to rapid sky variation. This is the project to explore the possibility to track system temeprature with alternative dataset (e.g. WVR, auto-correlation or SQLD data). The purpose is :
1. See if we reduce the number of Tsys measurements using these alternative datasets. 
2. See if this method will improve our flux calibration and brings down flux unstability. 

Currently we found that only WVR data can track Tsys well. My steps to demonstrate the viability of these methods is as following:
1. Prodcue images using original calibration and make dirty images with `tclean`
2. Substitute individual Tsys measurements by the value tracked by alternative datasets. Then we make the images again and compare fluxes to see if it agrees well. This is called the **first method**.  
3. Make the system temperature table with only the start of Tsys measurements for bandpass, phase and science targets separately. Normalize the continous WVR data and write it as gain table and feed it into the Tsys calibration. This is called the **second method**. 

The detailed description can be found in ALMA memo. 
### EXECUTIVE SUMMARY
The general scripts are in [scripts](scripts) directory. The scripts work for `CASA 5.6.1`. The steps to run scripts and produce the image is below:
1. Download the data and generate calibration scripts by running [dataPrep.casa.py](scripts/dataPrep.casa.py). 
2. Calibrate the dataset with original method.  
    1. Run the generated calibration script to produce the calibrated measurement set using the original method. 
    2. I have renamed the generated script to be [scriptForCalibration_v0.casa.py](scripts/scriptForCalibration_v0.py).
3. Calibrate the dataset with **first method**
    1. Run [Tsys_write_WVR_v1.casa.py](scripts/Tsys_write_WVR_v1.casa.py) to generate the alternative system temperature table for the measurement set using the **first method**.
    2. Modify the original calibration script to use the alternative Tsys table generated by the first method. The modified script is named [scriptForCalibration_v1.casa.py](scripts/scriptForCalibration_v1.casa.py). 
4. Calibration the dataset with the **second method**.
    1. Run[Tsys_write_WVR_v3.casa.py](scripts/Tsys_write_WVR_v3.casa.py) to generate the alternative system temperature table for the measurement set using the **second method**. 
    2. Modify the original calibration script to use the alternative Tsys table generated by the first method. The modified script is named [scriptForCalibration_v3.casa.py](scripts/scriptForCalibration_v3.casa.py).
5. Image all 3 datasets with [tclean.casa.py](tclean.casa.py). Compare the flux of the 3 images. 
